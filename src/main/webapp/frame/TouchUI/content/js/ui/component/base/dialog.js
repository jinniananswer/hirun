/*!
 * dialog component
 * http://www.wadecn.com/
 * auth:xiedx@asiainfo.com
 * Copyright 2015, WADE
 */
!function(e,t,i){"use strict";if(e&&"undefined"==typeof e.Dialog){var n=200,o=Array.prototype.push,r=Array.prototype.splice,a=e.os.phone||!0===e.ratioPhone,l=[],d=function(t,n){var o=this;o.el=t&&1==t.nodeType?t:i.getElementById(t),o.el&&o.el.nodeType&&(o.id=e.attr(o.el,"id"))&&(n&&e.isObject(n)&&e.extend(o,n),e.attr(o.el,"x-wade-uicomponent")||e.attr(o.el,"x-wade-uicomponent","dialog"),o._init(),o.constructor.call(o))};if(d.prototype=e.extend(new e.UIComponent,{show:function(t){var i=this;i.el.style.zIndex=e.zIndexer.get(i.id),i.el.style.display="",i.visible=!0,g(i.content,i.id),v(i.content),w(i.content),o.call(l,i.id)},hide:function(){var t=this;!1!==t.visible&&!1!==e.event.trigger("hideAction",null,t.el)&&(e.zIndexer.remove(t.id),t.el.style.display="none",t.visible=!1,r.call(l,e.inArray(t.id,l),1))},dragStart:function(t,n,o){var r=this;if(!t||!t.nodeType||!e.nodeName(t,"div"))return!1;for(var a=0,l=t,d=!1,s=!1;a<6&&l;){if(l.nodeType&&l.parentNode&&l.parentNode.nodeType&&("text"==l.className&&(d=!0),e.nodeName(l.parentNode,"div")&&r.id==e.attr(l.parentNode,"id"))){s=!0;break}l=l.parentNode,a++}if(!s||!d)return!1;var p=(i.body.offsetWidth,i.body.offsetHeight,r.wrapper.offsetWidth),u=r.wrapper.offsetHeight,f=r.wrapper.offsetLeft,c=r.wrapper.offsetTop,h=n-f,g=o-c;return!(h<=0||g<=0)&&(r.dragContentWidth=p,r.dragContentHeight=u,r.dragDistX=h,r.dragDistY=g,"absolute"!=r.wrapper.style.position&&(r.wrapper.style.position="absolute",r.wrapper.style.left=f+"px",r.wrapper.style.top=c+"px"),!0)},dragMove:function(e,t){var n=this,o=e,r=t,a=i.body.offsetWidth,l=i.body.offsetHeight,d=a-n.dragContentWidth,s=l-n.dragContentHeight;o-=n.dragDistX,r-=n.dragDistY,o<0&&(o=0),r<0&&(r=0),o>d&&(o=d),r>s&&(r=s),n.wrapper.style.left=o+"px",n.wrapper.style.top=r+"px"},dragEnd:function(){},getFrame:function(e){return t[e]},setPopupReturnValue:function(i,n,o){var r=this;if(i){e.isPlainObject(i)&&(o=n);var a=r.srcWindow?r.srcWindow:t;y(a,i,n),!1!==o&&r.hide(),e.event.trigger({type:"afterAction",context:a},null,r.el)}},back:function(e,t,i,n){var o=this;o.hide()},destroy:function(){var t=this;e.zIndexer.remove(t.id),t.srcWindow=null,t.wrapper=null,t.titleText=null,t.titleFnClose=null,t.content=null,t.el=null},_init:function(){var t=this;t.wrapper=e(t.el).children("div.wrapper:first")[0],t.titleText=e(t.el).find("div.text:first")[0],t.titleFnClose=e(t.el).find("div.close:first")[0],t.content=e(t.wrapper).children("div.content:first")[0],t.width&&(t.wrapper.style.width=t.width),t.height&&(t.content.style.height=t.height),e(t.titleFnClose).tap(function(){t.hide()})}}),!e.os.pad&&!a){var s,p,u,f=!1,c=!1,h=null;e(i).mousedown(function(e){0!=e.button&&1!=e.button||l.length&&(f=c=!1,s=e.target,p=e.pageX,u=e.pageY,h=t.setTimeout(function(){var e=t[l[l.length-1]];e&&(f=e.dragStart(s,p,u)),f&&(i.body.style.cursor="move")},n))}),e(i).mousemove(function(e){if((0==e.button||1==e.button)&&l.length&&f){c=!0;var i=t[l[l.length-1]];i&&i.dragMove(e.pageX,e.pageY)}}),e(i).mouseup(function(e){0!=e.button&&1!=e.button||(s=p=u=null,h&&t.clearTimeout(h),f&&(f=c=!1,i.body&&(i.body.style.cursor="")))})}var g=function(i,n){if(e.Frame&&e.isFunction(e.Frame)&&e.Frame.prototype._init){var o,r;e("iframe[x-wade-uicomponent=frame]",i).each(function(){o=e.attr(this,"id"),(r=t[o])&&r instanceof e.Frame&&(r.setAttribute("popupId",n),!0!==r.inited?setTimeout("window['"+o+"'].init()",1):setTimeout("window['"+o+"'].adjust();window['"+o+"'].focus();",1))})}},v=function(i){if(e.Scroller&&e.isFunction(e.Scroller)&&e.Scroller.prototype._init){var n,o;e("div[x-wade-uicomponent=scroller]",i).each(function(){n=e.attr(this,"id"),(o=t[n])&&o instanceof e.Scroller&&setTimeout("window['"+n+"'].refresh()",1)})}},w=function(i){if(e.Table&&e.isFunction(e.Table)&&e.Table.prototype._init){var n,o;e("div[x-wade-uicomponent=table]",i).each(function(){n=e.attr(this,"id"),(o=t[n])&&o instanceof e.Table&&setTimeout("window['"+n+"'].adjust()",1)})}},y=function(t,i,n){if(t&&t.Wade&&t.$)if(e.isString(i))t.$("#"+i).val(n);else if(e.isPlainObject(i))for(var o in i)t.$("#"+o).val(i[o]);else if(e.isArray(i)&&i.length&&i.length%2==0)for(var r=0;r<i.length;r+=2){var o=i[r],a=i[r+1];o&&"undefined"!=o&&t.$("#"+o).val(a)}};t.Dialog=e.Dialog=d}}(window.Wade,window,document);